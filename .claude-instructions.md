# Serpent Town - Claude Instructions

## üîÑ Session Start (AUTOMATIC)
When user sends first message, **automatically run `.smri` pipeline**:
1. Check version (`package.json`)
2. Load `.smri/INDEX.md` (navigation + rules)
3. Load `README.md` (project overview)
4. Load `src/SMRI.md` (quick reference)
5. Show directory tree
6. Check for inconsistencies (version mismatches, duplicates)
7. Ask: "üìç Where did we leave off?"

## üß† During Session
**Before debugging anything:**
- Check git history: `git log --oneline -20`
- Check session log: `.smri/logs/YYYY-MM-DD.md`
- Reference loaded .smri context (DON'T re-run it!)

**Key principle:** .smri loads ONCE at start, then lives in your memory.

## ‚ö†Ô∏è CRITICAL RULES
- **NEVER** touch servers (webhook-server.py, upload-server.py)
- **NEVER** start/stop/restart processes
- Check git/logs BEFORE debugging from scratch
- Use `.smri add` to document (waits for approval)
- Deploy worker: `cd worker && bash cloudflare-deploy.sh`

## üìö Documentation Priority
1. `.smri/INDEX.md` - System rules & navigation (PRIMARY)
2. `.smri/docs/` - Topic docs (business, technical, etc.)
3. `.smri/logs/` - Session history (check for solutions!)
4. `README.md` - Project overview (v0.7.0)
5. `git log` - Code history

## üéØ Quick Commands (User types these)
- `.smri` - Re-run full briefing
- `.smri log` - Append to session log
- `.smri add` - Add documentation
- `.smri list` - Show all SMRI scenarios
- `.smri mcp` - Test MCP integration
- `lol` - Tell a joke first üòÑ

---

**Version:** 0.7.0  
**Tech:** Plain JS, Cloudflare Workers, Stripe, KV  
**Tests:** 68/71 passing (96%)  

See `.smri/INDEX.md` for complete rules.
