<!DOCTYPE html>
<html>
<head>
  <title>Debug Test</title>
  <style>
    body { background: #000; color: #0f0; font-family: monospace; padding: 20px; }
    .log { margin: 5px 0; padding: 5px; border-left: 3px solid #0f0; }
    .error { color: #f00; border-left-color: #f00; }
  </style>
</head>
<body>
  <h1>Testing TestRunner</h1>
  <button onclick="runTest()">Run Test</button>
  <div id="logs"></div>

  <script type="module">
    const logs = document.getElementById('logs');
    
    function log(msg, isError = false) {
      const div = document.createElement('div');
      div.className = isError ? 'log error' : 'log';
      div.textContent = new Date().toISOString() + ' - ' + msg;
      logs.appendChild(div);
      console.log(msg);
    }

    window.runTest = async function() {
      logs.innerHTML = '';
      log('Starting test...');
      
      try {
        log('Importing TestRunner...');
        const { TestRunner } = await import('./modules/test-runner.js');
        log('TestRunner imported successfully');
        
        log('Importing GameStorage...');
        const { createGameStorage } = await import('../src/modules/game/storage-client.js');
        log('GameStorage imported successfully');
        
        log('Creating storage...');
        const storage = createGameStorage({
          backend: 'localStorage',
          namespace: 'test'
        });
        log('Storage created');
        
        log('Creating test group...');
        const testGroup = {
          name: 'Test',
          icon: 'ðŸ§ª',
          module: 'TEST',
          tests: [{
            id: 'test-1',
            number: '1',
            method: 'GET',
            name: 'Test',
            endpoint: 'test.html',
            run: async () => {
              log('Running test function...');
              const response = await fetch('tutorial-happy-path.html', { method: 'HEAD' });
              log('Fetch complete: ' + response.status);
              return { status: response.status };
            }
          }]
        };
        log('Test group created');
        
        log('Creating TestRunner...');
        const runner = new TestRunner({
          containerId: 'test-container',
          testGroups: [testGroup]
        });
        log('TestRunner created');
        
        log('Running single test...');
        await runner.runSingleTest('test-1');
        log('Test complete!');
        
      } catch (error) {
        log('ERROR: ' + error.message, true);
        log('Stack: ' + error.stack, true);
        log('Error type: ' + typeof error, true);
        log('Error object: ' + JSON.stringify(error, Object.getOwnPropertyNames(error)), true);
      }
    };
  </script>
  
  <div id="test-container"></div>
</body>
</html>
