<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{SCENARIO_CODE}} - {{SCENARIO_NAME}}</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: #0a0e14;
      color: #c9d1d9;
      padding: 20px;
      max-width: 1200px;
      margin: 0 auto;
    }
    
    .header {
      margin-bottom: 30px;
      padding-bottom: 20px;
      border-bottom: 2px solid #30363d;
    }
    
    .smri-code {
      font-size: 14px;
      color: #8b949e;
      font-family: 'Courier New', monospace;
      margin-bottom: 10px;
    }
    
    h1 {
      color: #58a6ff;
      font-size: 28px;
      margin-bottom: 10px;
    }
    
    .meta {
      display: flex;
      gap: 20px;
      margin-top: 15px;
      flex-wrap: wrap;
    }
    
    .meta-item {
      display: flex;
      align-items: center;
      gap: 8px;
      background: #161b22;
      padding: 8px 16px;
      border-radius: 6px;
      border: 1px solid #30363d;
    }
    
    .meta-label {
      color: #8b949e;
      font-size: 13px;
    }
    
    .meta-value {
      color: #c9d1d9;
      font-weight: 600;
      font-size: 13px;
    }
    
    .test-section {
      background: #161b22;
      border: 2px solid #30363d;
      border-radius: 12px;
      padding: 25px;
      margin-bottom: 20px;
    }
    
    .test-section h2 {
      color: #58a6ff;
      font-size: 18px;
      margin-bottom: 15px;
    }
    
    .description {
      color: #8b949e;
      line-height: 1.6;
      margin-bottom: 20px;
    }
    
    .test-card {
      background: #0d1117;
      border: 1px solid #30363d;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 15px;
    }
    
    .test-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }
    
    .test-name {
      color: #c9d1d9;
      font-weight: 600;
      font-size: 16px;
    }
    
    .test-status {
      padding: 6px 12px;
      border-radius: 6px;
      font-size: 13px;
      font-weight: 600;
    }
    
    .status-pending { background: #30363d; color: #8b949e; }
    .status-running { background: #1f6feb; color: white; }
    .status-pass { background: #238636; color: white; }
    .status-fail { background: #da3633; color: white; }
    
    .request-info {
      background: #010409;
      border: 1px solid #30363d;
      border-radius: 6px;
      padding: 15px;
      margin: 15px 0;
    }
    
    .request-method {
      color: #3fb950;
      font-weight: bold;
      font-family: 'Courier New', monospace;
      font-size: 14px;
    }
    
    .request-url {
      color: #58a6ff;
      font-family: 'Courier New', monospace;
      font-size: 13px;
      word-break: break-all;
    }
    
    .response-output {
      background: #010409;
      border: 1px solid #30363d;
      border-radius: 6px;
      padding: 15px;
      font-family: 'Courier New', monospace;
      font-size: 13px;
      max-height: 300px;
      overflow-y: auto;
      margin-top: 10px;
    }
    
    .response-success { color: #3fb950; }
    .response-error { color: #f85149; }
    .response-warning { color: #d29922; }
    
    .btn {
      background: #238636;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 600;
      transition: all 0.2s;
      margin-right: 10px;
    }
    
    .btn:hover { background: #2ea043; }
    .btn:disabled { background: #30363d; cursor: not-allowed; opacity: 0.5; }
    
    .btn-primary { background: #1f6feb; }
    .btn-primary:hover { background: #388bfd; }
    
    .dependencies {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      margin-bottom: 20px;
    }
    
    .dep-badge {
      background: #30363d;
      color: #8b949e;
      padding: 6px 12px;
      border-radius: 6px;
      font-size: 12px;
      border: 1px solid #30363d;
    }
    
    .dep-badge.active {
      background: #238636;
      color: white;
      border-color: #238636;
    }
  </style>
</head>
<body>
  <div class="header">
    <div class="smri-code">SMRI: {{SCENARIO_CODE}}</div>
    <h1>{{SCENARIO_NAME}}</h1>
    
    <div class="meta">
      <div class="meta-item">
        <span class="meta-label">Module:</span>
        <span class="meta-value">{{MODULE}}</span>
      </div>
      <div class="meta-item">
        <span class="meta-label">Priority:</span>
        <span class="meta-value">{{PRIORITY}}</span>
      </div>
      <div class="meta-item">
        <span class="meta-label">Layer:</span>
        <span class="meta-value">{{LAYER}}</span>
      </div>
    </div>
  </div>

  <div class="test-section">
    <h2>üìã Scenario Description</h2>
    <p class="description">{{DESCRIPTION}}</p>
    
    <h3 style="color: #8b949e; font-size: 14px; margin-top: 20px; margin-bottom: 10px;">Dependencies:</h3>
    <div class="dependencies" id="dependencies">
      <!-- Dynamically populated -->
    </div>
  </div>

  <div class="test-section">
    <h2>üß™ Test Cases (<span id="testCount">0</span>)</h2>
    <button class="btn btn-primary" onclick="runAllTests()">‚ñ∂ Run All Tests</button>
    
    <div id="testContainer">
      <!-- Test cards dynamically populated -->
    </div>
  </div>

  <script>
    const SCENARIO_CONFIG = {
      code: '{{SCENARIO_CODE}}',
      name: '{{SCENARIO_NAME}}',
      module: '{{MODULE}}',
      priority: {{PRIORITY}},
      layer: '{{LAYER}}',
      dependencies: {{DEPENDENCIES}},
      tests: {{TESTS}}
    };

    // Initialize
    function init() {
      renderDependencies();
      renderTests();
      document.getElementById('testCount').textContent = SCENARIO_CONFIG.tests.length;
    }

    function renderDependencies() {
      const container = document.getElementById('dependencies');
      SCENARIO_CONFIG.dependencies.forEach(dep => {
        const badge = document.createElement('div');
        badge.className = 'dep-badge';
        badge.textContent = `‚Üí ${dep}`;
        container.appendChild(badge);
      });
    }

    function renderTests() {
      const container = document.getElementById('testContainer');
      SCENARIO_CONFIG.tests.forEach((test, index) => {
        const card = createTestCard(test, index);
        container.appendChild(card);
      });
    }

    function createTestCard(test, index) {
      const card = document.createElement('div');
      card.className = 'test-card';
      card.innerHTML = `
        <div class="test-header">
          <div class="test-name">${test.name}</div>
          <div class="test-status status-pending" id="status-${index}">Pending</div>
        </div>
        <div class="description">${test.description}</div>
        <div class="request-info">
          <div><span class="request-method">${test.method}</span> <span class="request-url">${test.url}</span></div>
        </div>
        <button class="btn" onclick="runTest(${index})">‚ñ∂ Run Test</button>
        <div class="response-output" id="output-${index}" style="display: none;"></div>
      `;
      return card;
    }

    async function runTest(index) {
      const test = SCENARIO_CONFIG.tests[index];
      const statusEl = document.getElementById(`status-${index}`);
      const outputEl = document.getElementById(`output-${index}`);
      
      statusEl.textContent = 'Running...';
      statusEl.className = 'test-status status-running';
      outputEl.style.display = 'block';
      outputEl.innerHTML = '<div style="color: #8b949e;">Executing request...</div>';
      
      try {
        const response = await fetch(test.url, {
          method: test.method,
          headers: test.headers || {}
        });
        
        const data = await response.json();
        const result = test.validator(data);
        
        if (result.pass) {
          statusEl.textContent = '‚úÖ Pass';
          statusEl.className = 'test-status status-pass';
          outputEl.innerHTML = `<div class="response-success">${result.message}</div>`;
        } else {
          statusEl.textContent = '‚ùå Fail';
          statusEl.className = 'test-status status-fail';
          outputEl.innerHTML = `<div class="response-error">Error: ${result.message}</div>`;
        }
        
        outputEl.innerHTML += `<div style="color: #8b949e; margin-top: 10px;">Response:</div>`;
        outputEl.innerHTML += `<pre style="color: #c9d1d9; margin-top: 5px;">${JSON.stringify(data, null, 2)}</pre>`;
        
      } catch (err) {
        statusEl.textContent = '‚ùå Fail';
        statusEl.className = 'test-status status-fail';
        outputEl.innerHTML = `<div class="response-error">Error: ${err.message}</div>`;
      }
    }

    async function runAllTests() {
      for (let i = 0; i < SCENARIO_CONFIG.tests.length; i++) {
        await runTest(i);
        await new Promise(resolve => setTimeout(resolve, 500));
      }
    }

    // Initialize on load
    init();
  </script>
</body>
</html>
