<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">
  <title>ğŸ Debug Hub - Snake Muffin v0.7.2</title>
  <link rel="stylesheet" href="../styles.css?v=20260104">
  <script type="module" src="../src/components/Navigation.js"></script>
  <style>
    .debug-content {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: #0a0e14;
      color: #c9d1d9;
      padding: 20px;
      max-width: 1400px;
      margin: 0 auto;
      min-height: 100vh;
    }
    body { background: #0a0e14; }
    h1 { color: #58a6ff; margin-bottom: 10px; }
    .subtitle { color: #8b949e; margin-bottom: 30px; font-size: 14px; }
    .modules-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }
    .module-card {
      background: #161b22;
      border: 2px solid #30363d;
      border-radius: 12px;
      padding: 20px;
      transition: all 0.2s;
    }
    .module-card:hover {
      border-color: #58a6ff;
      transform: translateY(-2px);
    }
    .module-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
      cursor: pointer;
    }
    .module-title { font-size: 18px; font-weight: 600; color: #58a6ff; }
    .module-badge {
      background: #238636;
      color: white;
      padding: 4px 10px;
      border-radius: 12px;
      font-size: 11px;
      font-weight: bold;
    }
    .module-stats {
      display: flex;
      gap: 15px;
      margin-top: 10px;
      font-size: 13px;
      color: #8b949e;
    }
    .stat-item { display: flex; align-items: center; gap: 5px; }
    .progress-bar-mini {
      width: 100%;
      height: 8px;
      background: #21262d;
      border-radius: 4px;
      overflow: hidden;
      margin-top: 10px;
    }
    .progress-fill-mini {
      height: 100%;
      background: linear-gradient(90deg, #238636, #2ea043);
      transition: width 0.3s;
    }
    .subcategories {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 10px;
    }
    .module-links {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-top: 15px;
    }
    .module-link {
      color: #58a6ff;
      text-decoration: none;
      font-size: 13px;
      padding: 8px;
      background: #0d1117;
      border-radius: 6px;
      transition: all 0.2s;
    }
    .module-link:hover {
      background: #1c2128;
      transform: translateX(5px);
    }
    .subcat-badge {
      background: #21262d;
      color: #8b949e;
      padding: 4px 8px;
      border-radius: 6px;
      font-size: 11px;
    }
    details { margin-top: 15px; }
    summary {
      cursor: pointer;
      color: #58a6ff;
      font-size: 12px;
      padding: 8px;
      background: #0d1117;
      border-radius: 6px;
    }
    summary:hover { background: #161b22; }
  </style>
</head>
<body>
  <div class="debug-content">
    <h1>ğŸ Snake Muffin - Debug Hub</h1>
    <p class="subtitle">
      <strong>Version:</strong> <span id="app-version">Loading...</span> | 
      <strong>SMRI:</strong> <span id="smri-count">Loading...</span> scenarios | 
      <strong>Progress:</strong> <span id="overall-progress">Loading...</span> |
      <strong>Updated:</strong> <span id="page-timestamp" style="color: #8b949e; font-size: 12px;">2026-01-04</span>
  </p>

  <!-- Quick Access -->
  <div style="background: #161b22; border: 2px solid #30363d; border-radius: 12px; padding: 20px; margin-bottom: 30px;">
    <h2 style="color: #58a6ff; margin-bottom: 15px; font-size: 18px;">ğŸš€ Quick Access - Core Pages</h2>
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
      <a href="../game.html" style="background: linear-gradient(135deg, #8957e5 0%, #6366f1 100%); color: white; padding: 15px; border-radius: 8px; text-decoration: none; font-weight: 600; transition: all 0.2s; display: block;" onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
        ğŸ® Game (Tamagotchi)<br>
        <span style="font-size: 12px; font-weight: normal; opacity: 0.9;">Main snake care game - feed, water, clean</span>
      </a>
      <a href="../catalog.html" style="background: linear-gradient(135deg, #1f6feb 0%, #0969da 100%); color: white; padding: 15px; border-radius: 8px; text-decoration: none; font-weight: 600; transition: all 0.2s; display: block;" onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
        ğŸ›’ Shop Catalog<br>
        <span style="font-size: 12px; font-weight: normal; opacity: 0.9;">Browse & buy snakes with Stripe checkout</span>
      </a>
      <a href="../collection.html" style="background: linear-gradient(135deg, #f77f00 0%, #fb923c 100%); color: white; padding: 15px; border-radius: 8px; text-decoration: none; font-weight: 600; transition: all 0.2s; display: block;" onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
        ğŸ  My Collection<br>
        <span style="font-size: 12px; font-weight: normal; opacity: 0.9;">View your purchased snakes</span>
      </a>
      <a href="../dex.html" style="background: linear-gradient(135deg, #06b6d4 0%, #0891b2 100%); color: white; padding: 15px; border-radius: 8px; text-decoration: none; font-weight: 600; transition: all 0.2s; display: block;" onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
        ğŸ“– Morph Dex<br>
        <span style="font-size: 12px; font-weight: normal; opacity: 0.9;">Encyclopedia of all morphs & genetics</span>
      </a>
      <a href="../calculator-integrated.html" style="background: linear-gradient(135deg, #9333ea 0%, #7e22ce 100%); color: white; padding: 15px; border-radius: 8px; text-decoration: none; font-weight: 600; transition: all 0.2s; display: block;" onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
        ğŸ§¬ Breeding Calculator (S3)<br>
        <span style="font-size: 12px; font-weight: normal; opacity: 0.9;">Dual-view: MorphMarket + Serpent Town genetics</span>
      </a>
      <a href="../learn.html" style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); color: white; padding: 15px; border-radius: 8px; text-decoration: none; font-weight: 600; transition: all 0.2s; display: block;" onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
        ğŸ“š Tutorial (S2-7)<br>
        <span style="font-size: 12px; font-weight: normal; opacity: 0.9;">Interactive onboarding for new users</span>
      </a>
    </div>
  </div>

  <!-- Debug Tools -->
  <div style="background: #161b22; border: 2px solid #30363d; border-radius: 12px; padding: 20px; margin-bottom: 30px;">
    <h2 style="color: #58a6ff; margin-bottom: 15px; font-size: 18px;">ğŸ› ï¸ Debug Tools</h2>
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
      <a href="smri-runner.html" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 15px; border-radius: 8px; text-decoration: none; font-weight: 600; transition: all 0.2s; display: block;" onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
        ğŸ§ª SMRI Test Runner<br>
        <span style="font-size: 12px; font-weight: normal; opacity: 0.9;">Automated browser testing with live rendering</span>
      </a>
      <a href="healthcheck.html" style="background: linear-gradient(135deg, #238636 0%, #2ea043 100%); color: white; padding: 15px; border-radius: 8px; text-decoration: none; font-weight: 600; transition: all 0.2s; display: block;" onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
        ğŸ¥ System Health Check<br>
        <span style="font-size: 12px; font-weight: normal; opacity: 0.9;">Test all API endpoints & connections</span>
      </a>
      <a href="kv-manager.html" style="background: linear-gradient(135deg, #f85149 0%, #ff6b6b 100%); color: white; padding: 15px; border-radius: 8px; text-decoration: none; font-weight: 600; transition: all 0.2s; display: block;" onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
        ğŸ“Š KV Manager<br>
        <span style="font-size: 12px; font-weight: normal; opacity: 0.9;">Inspect & manage Cloudflare KV data</span>
      </a>
      <a href="purchase-flow-demo.html" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 15px; border-radius: 8px; text-decoration: none; font-weight: 600; transition: all 0.2s; display: block;" onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
        ğŸ’³ Purchase Flow Demo<br>
        <span style="font-size: 12px; font-weight: normal; opacity: 0.9;">E2E purchase test (S1.1,2,3,4,5.01)</span>
      </a>
      <a href="test-cache.html" style="background: linear-gradient(135deg, #d946ef 0%, #c026d3 100%); color: white; padding: 15px; border-radius: 8px; text-decoration: none; font-weight: 600; transition: all 0.2s; display: block;" onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
        ğŸ’¾ Cache Test Tool<br>
        <span style="font-size: 12px; font-weight: normal; opacity: 0.9;">Test localStorage performance</span>
      </a>
      <a href="trait-dex.html" style="background: linear-gradient(135deg, #06b6d4 0%, #0891b2 100%); color: white; padding: 15px; border-radius: 8px; text-decoration: none; font-weight: 600; transition: all 0.2s; display: block;" onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
        ğŸ“– Trait Database<br>
        <span style="font-size: 12px; font-weight: normal; opacity: 0.9;">Browse genetics data (70+ morphs)</span>
      </a>
      <a href="../admin-kv.html" style="background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%); color: white; padding: 15px; border-radius: 8px; text-decoration: none; font-weight: 600; transition: all 0.2s; display: block;" onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
        âš™ï¸ Admin KV Panel<br>
        <span style="font-size: 12px; font-weight: normal; opacity: 0.9;">Advanced KV operations (admin only)</span>
      </a>
      <a href="../account.html" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; padding: 15px; border-radius: 8px; text-decoration: none; font-weight: 600; transition: all 0.2s; display: block;" onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
        ğŸ‘¤ Account Settings<br>
        <span style="font-size: 12px; font-weight: normal; opacity: 0.9;">User profile & preferences</span>
      </a>
    </div>
  </div>

  <!-- SMRI Scenarios - All Organized & Executable -->
  <div style="background: #161b22; border: 2px solid #30363d; border-radius: 12px; padding: 20px; margin-bottom: 30px;">
    <h2 style="color: #58a6ff; margin-bottom: 15px; font-size: 18px;">ğŸ§ª SMRI Test Scenarios - All Executable</h2>
    <p style="color: #8b949e; font-size: 13px; margin-bottom: 20px;">
      <strong id="smri-total">69</strong> total scenarios | 
      <strong id="smri-complete" style="color: #3fb950;">10</strong> complete | 
      <strong id="smri-progress" style="color: #d29922;">12</strong> in progress | 
      <strong id="smri-planned" style="color: #8b949e;">47</strong> planned
    </p>
    <div id="smri-categories" style="display: flex; flex-direction: column; gap: 15px;">
      Loading scenarios...
    </div>
  </div>

  <script type="module">
    import { VERSION, VERSION_CONFIG, getSMRIStats } from '../src/config/version.js?v=20260107';

    const stats = getSMRIStats();
    document.getElementById('app-version').textContent = VERSION.substring(1);
    document.getElementById('smri-count').textContent = stats.total;
    document.getElementById('overall-progress').textContent = `${stats.completed}/${stats.total} done (${stats.avgProgress}%)`;

    // Organize scenarios by category
    const categories = {
      'S0': { name: 'ğŸ¥ Health Checks', icon: 'ğŸ¥', color: '#238636', scenarios: [] },
      'S1': { name: 'ğŸ›’ Shop/Purchase', icon: 'ğŸ›’', color: '#1f6feb', scenarios: [] },
      'S2': { name: 'ğŸ® Game Core', icon: 'ğŸ®', color: '#8957e5', scenarios: [] },
      'S2-7': { name: 'ğŸ“š Tutorial System', icon: 'ğŸ“š', color: '#f77f00', scenarios: [] },
      'S3': { name: 'ğŸ” Auth/Identity', icon: 'ğŸ”', color: '#d29922', scenarios: [] },
      'S4': { name: 'ğŸ’³ Payment/Stripe', icon: 'ğŸ’³', color: '#f85149', scenarios: [] },
      'S5': { name: 'â˜ï¸ Worker/Backend', icon: 'â˜ï¸', color: '#58a6ff', scenarios: [] },
      'S6': { name: 'ğŸ¬ Demo System', icon: 'ğŸ¬', color: '#a855f7', scenarios: [] }
    };

    // Categorize scenarios
    VERSION_CONFIG.SMRI_SCENARIOS.forEach(scenario => {
      const code = scenario.code;
      if (code.startsWith('S2-7')) {
        categories['S2-7'].scenarios.push(scenario);
      } else if (code.startsWith('S0')) {
        categories['S0'].scenarios.push(scenario);
      } else if (code.startsWith('S1')) {
        categories['S1'].scenarios.push(scenario);
      } else if (code.startsWith('S2')) {
        categories['S2'].scenarios.push(scenario);
      } else if (code.startsWith('S3')) {
        categories['S3'].scenarios.push(scenario);
      } else if (code.startsWith('S4')) {
        categories['S4'].scenarios.push(scenario);
      } else if (code.startsWith('S5')) {
        categories['S5'].scenarios.push(scenario);
      } else if (code.startsWith('S6')) {
        categories['S6'].scenarios.push(scenario);
      }
    });

    // Update summary counts
    const complete = VERSION_CONFIG.SMRI_SCENARIOS.filter(s => s.done === 100).length;
    const inProgress = VERSION_CONFIG.SMRI_SCENARIOS.filter(s => s.done > 0 && s.done < 100).length;
    const planned = VERSION_CONFIG.SMRI_SCENARIOS.filter(s => s.done === 0).length;
    document.getElementById('smri-total').textContent = VERSION_CONFIG.SMRI_SCENARIOS.length;
    document.getElementById('smri-complete').textContent = complete;
    document.getElementById('smri-progress').textContent = inProgress;
    document.getElementById('smri-planned').textContent = planned;

    // Render categories
    const container = document.getElementById('smri-categories');
    container.innerHTML = '';

    Object.keys(categories).forEach(key => {
      const cat = categories[key];
      if (cat.scenarios.length === 0) return;

      const completed = cat.scenarios.filter(s => s.done === 100).length;
      const avgProgress = Math.round(cat.scenarios.reduce((sum, s) => sum + s.done, 0) / cat.scenarios.length);

      const section = document.createElement('details');
      section.style.cssText = 'background: #0d1117; border: 1px solid #30363d; border-radius: 8px; padding: 15px;';
      
      section.innerHTML = `
        <summary style="cursor: pointer; font-weight: 600; font-size: 15px; color: #c9d1d9; list-style: none; display: flex; justify-content: space-between; align-items: center;">
          <span>${cat.name} <span style="color: #8b949e; font-weight: normal; font-size: 13px;">(${cat.scenarios.length} scenarios)</span></span>
          <span style="display: flex; gap: 10px; align-items: center;">
            <span style="font-size: 12px; color: #8b949e;">${completed}/${cat.scenarios.length} done</span>
            <span style="background: ${cat.color}; color: white; padding: 4px 10px; border-radius: 12px; font-size: 11px;">${avgProgress}%</span>
          </span>
        </summary>
        <div style="margin-top: 15px; display: flex; flex-direction: column; gap: 8px;">
          ${cat.scenarios.map(s => {
            const statusIcon = s.done === 100 ? 'âœ…' : s.done > 0 ? 'ğŸ”„' : 'â¬œ';
            const statusColor = s.done === 100 ? '#3fb950' : s.done > 0 ? '#d29922' : '#8b949e';
            return `
              <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: #161b22; border-radius: 6px; border-left: 3px solid ${statusColor};">
                <div style="flex: 1;">
                  <div style="font-size: 12px; font-weight: 600; color: #58a6ff; font-family: monospace;">${s.code}</div>
                  <div style="font-size: 12px; color: #c9d1d9; margin-top: 2px;">${s.desc}</div>
                  <div style="font-size: 11px; color: #8b949e; margin-top: 4px;">
                    ${statusIcon} ${s.done}% complete | Version: ${s.ver}
                  </div>
                </div>
                <button 
                  onclick="window.location.href='smri-runner.html?scenario=${encodeURIComponent(s.code)}'"
                  style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; padding: 8px 16px; border-radius: 6px; font-size: 12px; font-weight: 600; cursor: pointer; white-space: nowrap;"
                  onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 12px rgba(102, 126, 234, 0.4)'"
                  onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'"
                >
                  â–¶ Run Test
                </button>
              </div>
            `;
          }).join('')}
        </div>
      `;

      container.appendChild(section);
    });
  </script>
  </div><!-- .debug-content -->
</body>
</html>
