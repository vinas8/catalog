<!DOCTYPE html>
<html>
<head>
  <title>Test Catalog Rendering</title>
  <style>
    body { font-family: monospace; padding: 20px; background: #0a0e14; color: #c9d1d9; }
    iframe { width: 100%; height: 600px; background: white; border: 2px solid #30363d; }
    .log { margin: 10px 0; padding: 8px; background: #161b22; border-left: 3px solid #58a6ff; }
  </style>
</head>
<body>
  <h1>üß™ Catalog Render Test</h1>
  <button onclick="testCatalog()">‚ñ∂Ô∏è Run Test</button>
  <div id="output"></div>
  <h2>Live Preview:</h2>
  <iframe id="frame" src="about:blank"></iframe>
  
  <script>
    const output = document.getElementById('output');
    const frame = document.getElementById('frame');
    
    function log(msg) {
      output.innerHTML += `<div class="log">${msg}</div>`;
    }
    
    async function testCatalog() {
      output.innerHTML = '';
      log('1Ô∏è‚É£ Loading catalog.html...');
      
      frame.src = 'http://localhost:8000/catalog.html';
      
      await new Promise(resolve => {
        frame.onload = resolve;
        setTimeout(resolve, 3000);
      });
      
      log('2Ô∏è‚É£ Waiting for JS to execute...');
      await new Promise(resolve => setTimeout(resolve, 3000));
      
      const doc = frame.contentDocument;
      const catalogItems = doc.querySelectorAll('.catalog-item');
      const loadingElements = doc.querySelectorAll('.loading');
      const availableContainer = doc.getElementById('available-snakes');
      
      log(`üì¶ .catalog-item elements: ${catalogItems.length}`);
      log(`‚è≥ .loading elements: ${loadingElements.length}`);
      
      if (availableContainer) {
        log(`‚úÖ #available-snakes container found`);
        log(`   innerHTML length: ${availableContainer.innerHTML.length} chars`);
        const available = availableContainer.querySelectorAll('.catalog-item:not(.virtual)');
        log(`   üêç Real snakes: ${available.length}`);
      }
      
      const virtualContainer = doc.getElementById('virtual-snakes');
      if (virtualContainer) {
        const virtual = virtualContainer.querySelectorAll('.catalog-item.virtual');
        log(`   üí∞ Virtual snakes: ${virtual.length}`);
      }
      
      if (catalogItems.length > 0) {
        const first = catalogItems[0];
        log(`‚úÖ First product: ${first.querySelector('h3')?.textContent || 'NO NAME'}`);
      } else {
        log('‚ùå NO PRODUCTS RENDERED');
      }
    }
  </script>
</body>
</html>
