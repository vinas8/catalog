<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ðŸŽ¬ Interactive Demo - Snake Muffin</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; }
  </style>
</head>
<body>
  <div id="demo-root"></div>

  <script type="module">
    import { Demo } from '/src/modules/demo/index.js';

    const demo = new Demo({
      containerId: 'demo-root',
      scenarios: [
        {
          icon: 'ðŸ›’',
          title: 'Complete Purchase Flow',
          smri: 'S1.1,2,3,4,5.01',
          description: 'Import â†’ Browse â†’ Purchase â†’ Game',
          steps: [
            {
              title: 'Browse Catalog',
              description: 'View available snakes',
              url: '/catalog.html',
              action: async (demo) => {
                demo.log('ðŸ“¦ Loading product catalog...', 'info');
                await demo.wait(2000);
                demo.log('âœ… Catalog loaded! Browse available snakes below', 'success');
              }
            },
            {
              title: 'View Snake Details',
              description: 'Click any snake to see details modal',
              url: '/catalog.html',
              action: async (demo) => {
                demo.log('â³ Waiting for products to load...', 'info');
                await demo.wait(2000);
                demo.log('ðŸ’¡ Click on any snake card to see details', 'info');
                demo.log('â„¹ï¸ Look for "View Details" button on any product', 'info');
                await demo.wait(1500);
              }
            },
            {
              title: 'Add to Cart',
              description: 'Add snake to shopping cart',
              url: '/catalog.html',
              action: async (demo) => {
                demo.log('ðŸ’¡ Click "Add to Cart" button', 'info');
                await demo.wait(2000);
              }
            },
            {
              title: 'Checkout',
              description: 'Complete Stripe payment',
              url: '/catalog.html#checkout',
              action: async (demo) => {
                demo.log('ðŸ’³ Use test card: 4242 4242 4242 4242', 'info');
                await demo.wait(2000);
              }
            },
            {
              title: 'View in Game',
              description: 'Snake appears in collection',
              url: '/game.html',
              action: async (demo) => {
                demo.log('ðŸŽ‰ Snake purchased successfully!', 'success');
                await demo.wait(1000);
              }
            }
          ]
        },
        {
          icon: 'ðŸŽ®',
          title: 'Game Tutorial',
          smri: 'S2.7,5,5-1.01',
          description: 'Learn to care for your snake',
          steps: [
            {
              title: 'Open Game',
              description: 'Load game page',
              url: '/game.html'
            },
            {
              title: 'Feed Snake',
              description: 'Click feed button',
              url: '/game.html',
              action: async (demo) => {
                demo.log('ðŸ– Click the "Feed" button', 'info');
                await demo.wait(2000);
              }
            },
            {
              title: 'Give Water',
              description: 'Click water button',
              url: '/game.html',
              action: async (demo) => {
                demo.log('ðŸ’§ Click the "Water" button', 'info');
                await demo.wait(2000);
              }
            },
            {
              title: 'Clean Enclosure',
              description: 'Click clean button',
              url: '/game.html',
              action: async (demo) => {
                demo.log('ðŸ§¹ Click the "Clean" button', 'info');
                await demo.wait(2000);
              }
            },
            {
              title: 'Check Stats',
              description: 'View snake health metrics',
              url: '/game.html',
              action: async (demo) => {
                demo.log('ðŸ“Š All stats should be 100%', 'success');
                await demo.wait(1000);
              }
            }
          ]
        },
        {
          icon: 'ðŸ‘”',
          title: 'Owner Dashboard',
          smri: 'S6.1,4,5.01',
          description: 'Manage inventory & view analytics',
          steps: [
            {
              title: 'Open Admin',
              description: 'Load admin dashboard',
              url: '/admin/index.html'
            },
            {
              title: 'Import CSV',
              description: 'Upload product catalog',
              url: '/admin/import.html',
              action: async (demo) => {
                demo.log('ðŸ“¤ Select CSV file or paste data', 'info');
                demo.log('ðŸ’¡ Note: Import requires Stripe secret key (backend only)', 'info');
                await demo.wait(2000);
              }
            },
            {
              title: 'View Catalog',
              description: 'See imported products',
              url: '/catalog.html',
              action: async (demo) => {
                demo.log('ðŸ”„ Clearing cache to show fresh products...', 'info');
                // Clear cache via iframe
                const iframe = document.getElementById('demo-iframe');
                if (iframe && iframe.contentWindow) {
                  try {
                    iframe.contentWindow.localStorage.removeItem('serpent_products_cache');
                    iframe.contentWindow.localStorage.removeItem('serpent_products_cache_time');
                    demo.log('âœ… Cache cleared!', 'success');
                  } catch (e) {
                    demo.log('âš ï¸ Could not clear cache (CORS)', 'info');
                  }
                }
                await demo.wait(1500);
                // Reload to show products
                demo.reloadIframe();
                demo.log('ðŸ“¦ Products should now be visible', 'success');
              }
            },
            {
              title: 'Manage KV',
              description: 'View storage data',
              url: '/admin-kv.html'
            },
            {
              title: 'View Orders',
              description: 'Check purchase history',
              url: '/admin/index.html',
              action: async (demo) => {
                demo.log('ðŸ“‹ Recent orders and revenue', 'info');
                await demo.wait(2000);
              }
            }
          ]
        }
      ]
    });

    demo.init();
    console.log('ðŸŽ¬ Demo system initialized');
  </script>
</body>
</html>
