# S3.2,3.01 - Breeding Calculator Genetics Data Load

**Version:** 0.8.0  
**Module:** Calculator (S3)  
**Status:** ‚úÖ Ready for Testing  
**Priority:** üî• High

---

## üìã Overview

Test breeding calculator with expanded genetics database (v2.0) - verify data loads, morphs display, and calculations work correctly.

**User Story:** As a breeder, I want to use the calculator with 70+ morphs and validated genetics data to plan my breeding projects.

---

## üéØ Test Scenario

### Setup
```javascript
// Clear cache to force fresh data load
localStorage.removeItem('genetics_cache');
sessionStorage.clear();
// Navigate to calculator
window.location = '/calculator-integrated.html';
```

### Steps

**1. Database Load (genetics-core.js)**
- Load `/calculator-integrated.html`
- Wait for genetics database to load
- Verify: Console shows "‚úÖ Loaded X morphs + Y combos from genetics database v2.0.0"
- Expected: 20+ morphs, 10 combos

**2. Morph Autocomplete**
- Click male morph input field
- Type: "ban"
- Verify: Dropdown shows "Banana" option
- Click "Banana" to select
- Verify: Tag appears with morph name

**3. Alias Matching**
- Click female morph input field
- Type: "coral glow"
- Verify: Matches to "Banana" (alias)
- Select and verify tag appears

**4. Basic Calculation (Co-dominant)**
- Male: Pastel
- Female: Pastel
- Click "Calculate" button
- Expected outcomes:
  - Super Pastel: 25%
  - Pastel: 50%
  - Normal: 25%
- Verify: Results display in offspring card
- Verify: No health warnings

**5. Health Risk Detection**
- Clear previous selection
- Male: Spider
- Female: Normal
- Click "Calculate"
- Expected outcomes:
  - Spider: 50%
  - Normal: 50%
- Verify: ‚ö†Ô∏è Health warning appears (Spider wobble)
- Verify: Risk level shows "HIGH"

**6. Lethal Combo Detection**
- Clear previous
- Male: Spider
- Female: Spider
- Click "Calculate"
- Expected: üö´ LETHAL COMBINATION alert
- Verify: Red error box appears
- Verify: Message: "No super Spider exists - likely lethal"
- Verify: Calculation blocked

**7. BEL Complex (Multi-gene)**
- Clear previous
- Male: Lesser
- Female: Mojave
- Click "Calculate"
- Expected outcomes:
  - Blue Eyed Leucistic: 25%
  - Lesser: 25%
  - Mojave: 25%
  - Lesser Mojave: 25%
- Verify: BEL result appears
- Verify: Market value shown (~600 USD)

**8. Popular Combo Recognition**
- Clear previous
- Male: Pastel, Spider (multi-select)
- Female: Normal
- Click "Calculate"
- Expected: "Bumblebee" appears in results
- Verify: Combo name displayed
- Verify: Health warning for Spider wobble

**9. Market Value Calculation**
- Any pairing selected
- Click "Calculate"
- Verify: üí∞ Market Value card appears
- Verify: Shows average value, max potential
- Verify: ROI estimation displayed

**10. Compatibility Score**
- Any pairing
- Click "Calculate"
- Verify: Score shown (0-100)
- Verify: Grade shown (A+ to F)
- Verify: Breeding recommendation appears

---

## ‚úÖ Success Criteria

### Data Loading
- [x] genetics-core.js loads morphs-expanded.json
- [x] Console shows v2.0.0 and count (20+ morphs, 10 combos)
- [x] No 404 errors in network tab
- [x] Fallback to v1.0 if v2.0 fails

### Morph Selection
- [ ] Autocomplete works (type 2+ chars)
- [ ] Exact match: "Banana" ‚Üí "Banana"
- [ ] Alias match: "Coral Glow" ‚Üí "Banana"
- [ ] Tag system: Click to add, √ó to remove
- [ ] Multi-select works (Pastel + Spider)

### Genetics Calculations
- [ ] Co-dominant: Correct percentages (25/50/25)
- [ ] Recessive het: Correct outcomes
- [ ] BEL complex: Produces correct BEL result
- [ ] Lethal detection: Blocks Spider √ó Spider, Lesser √ó Butter

### Health & Safety
- [ ] Spider wobble warning appears
- [ ] HGW wobble warning appears
- [ ] Champagne moderate risk shown
- [ ] Lethal combos blocked with red alert

### UI/UX
- [ ] Results show in 4-card grid
- [ ] Offspring card: Phenotypes + percentages
- [ ] Genetics card: CoI, diversity, heterozygosity
- [ ] Market card: Values and ROI
- [ ] Health card: Risk level + recommendation

### Performance
- [ ] Database loads in <500ms
- [ ] Calculation completes in <100ms
- [ ] No UI freezing or lag
- [ ] Smooth autocomplete (no flicker)

---

## üêõ Known Issues

### Expected Limitations
1. **Combo naming:** Popular combos may not auto-label (UI enhancement needed)
2. **Rare morphs:** Only 70+ morphs, not full 500+ MorphMarket coverage
3. **Price data:** Market values may be outdated (manual update needed)

### Acceptable Edge Cases
1. **Unknown morph:** Shows "not found" message (correct behavior)
2. **Typos:** Partial match may not work (user fixes spelling)
3. **Line compatibility:** Axanthic VPI √ó TSK won't detect incompatibility (future enhancement)

---

## üîß Debug Commands

```javascript
// Check database status
console.log(await loadGeneticsDatabase());

// Inspect loaded data
console.log(morphsData);
console.log(morphMap);
console.log(healthRiskMap);

// Test morph lookup
console.log(getMorphValue('banana')); // Should return 150
console.log(getHealthRisk('spider')); // Should return 'high'

// Test lethal combo
console.log(checkLethalCombo('spider', 'spider')); // Should return lethal message
```

---

## üìä Test Data

### Test Pairings (Quick)
```javascript
// Basic co-dom
{ male: ['pastel'], female: ['pastel'] }

// Health risk
{ male: ['spider'], female: ['normal'] }

// Lethal
{ male: ['spider'], female: ['spider'] }

// BEL complex
{ male: ['lesser'], female: ['mojave'] }

// Multi-gene
{ male: ['pastel', 'banana'], female: ['normal'] }
```

### Expected Console Output
```
üß¨ Initializing breeding calculator...
‚úÖ Loaded 20 morphs + 10 combos from genetics database v2.0.0
‚úÖ Genetics database loaded
```

---

## üì∏ Visual Validation

### Screenshot Checklist
- [ ] Calculator loads without errors
- [ ] Morphs appear in autocomplete dropdown
- [ ] Tags display correctly when selected
- [ ] Results show in 4-card grid layout
- [ ] Health warnings appear with correct colors (red/yellow)
- [ ] Lethal alert is prominent and blocks calculation

---

## üöÄ Next Steps After Pass

1. **Add to smri-runner.html** - Include in scenario dropdown
2. **Create automated test** - Puppeteer script for CI
3. **MorphMarket parity** - Manual verification of 15 test cases
4. **User feedback** - Beta test with real breeders
5. **Expand to 200+ morphs** - Phase 2 data extraction

---

## üîó Related Files

- `/calculator-integrated.html` - Main calculator page
- `/src/modules/breeding/genetics-core.js` - Core logic
- `/data/genetics/morphs-expanded.json` - v2.0 database
- `/data/genetics/morphmarket-parity-checklist.json` - Test cases
- `/data/genetics/snakedb-enrichment.json` - Validation data

---

## üìù Test Log Template

```
Date: 2026-01-06
Tester: [Name]
Browser: Chrome/Firefox/Safari [Version]
Server: localhost:8000

| Test | Status | Notes |
|------|--------|-------|
| Database Load | ‚è≥ | |
| Autocomplete | ‚è≥ | |
| Basic Calc | ‚è≥ | |
| Health Warning | ‚è≥ | |
| Lethal Detection | ‚è≥ | |
| BEL Complex | ‚è≥ | |
| Market Value | ‚è≥ | |
| Compatibility | ‚è≥ | |

Overall: ‚è≥ Pass / Fail / Partial

Issues Found:
- [List any bugs here]

Recommendations:
- [Improvement suggestions]
```

---

**Created:** 2026-01-06T15:13:00Z  
**Ready for:** Manual browser testing  
**Estimated time:** 10-15 minutes
